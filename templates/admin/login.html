{{define "loginPage"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login | Lamahuraancomm</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <style>
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }
        @keyframes blink {
            50% { opacity: 0; }
        }
        body {
            background: linear-gradient(135deg, #1d0f2b, #3b205d, #4c66a0);
            background-size: 200% 200%;
            animation: gradientBG 15s ease infinite;
            overflow: hidden; /* Prevent scrollbars from the canvas */
        }

        #particle-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* Place canvas behind everything */
        }

        .logo-text {
            background: linear-gradient(90deg, #a78bfa, #f472b6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .icon-pulse {
            animation: pulse 3s ease-in-out infinite;
        }

        .login-card {
            /* Transition is handled by JS for smoothness */
            transform-style: preserve-3d;
        }

        input:focus {
            box-shadow: 0 0 0 2px rgba(167, 139, 250, 0.4);
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e1b34; }
        ::-webkit-scrollbar-thumb { background: #a78bfa; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #8b5cf6; }

        .password-toggle { cursor: pointer; transition: all 0.2s; }
        .password-toggle:hover { color: #a78bfa; }
        
        #typewriter-cursor {
            animation: blink 1s step-end infinite;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen text-gray-200 p-4">
    <canvas id="particle-canvas"></canvas>
    <div class="relative z-10 flex flex-col md:flex-row items-center justify-center w-full max-w-6xl gap-8">
        <!-- Left Side - Branding -->
        <div class="w-full md:w-1/2 flex flex-col items-center md:items-start text-center md:text-left mb-10 md:mb-0">
            <div class="flex items-center mb-6">
                <i class='bx bxs-music text-5xl text-violet-400 mr-4 icon-pulse'></i>
                <div>
                    <h1 class="text-4xl md:text-5xl font-bold logo-text">Lamahuraancomm</h1>
                    <h2 class="text-lg font-medium text-violet-300 tracking-widest uppercase -mt-1">Skiza Platform</h2>
                </div>
            </div>
            <p id="tagline" class="text-lg text-gray-400 max-w-md mb-8 h-12">
                <!-- Content will be typed by JS -->
            </p>
        </div>

        <!-- Right Side - Login Form -->
        <div class="w-full md:w-1/2 flex justify-center perspective-[1000px]">
            <div id="login-card" class="login-card bg-slate-900/60 border border-slate-700 backdrop-blur-sm p-8 md:p-10 rounded-xl shadow-2xl shadow-violet-500/10 w-full max-w-md hover:shadow-violet-500/20">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold logo-text">Tune In</h2>
                    <p class="text-gray-400 mt-2">Access your dashboard</p>
                </div>

                <form action="/login" method="post" class="space-y-5">
                    <div><label for="email" class="block text-sm font-medium text-gray-400 mb-2">Email</label><div class="relative"><i class='bx bx-envelope absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-lg'></i><input type="email" name="email" id="email" placeholder="your@email.com" required class="w-full pl-10 pr-4 py-3 rounded-lg border border-slate-600 bg-slate-800/50 focus:border-violet-500 focus:ring-0 focus:outline-none text-gray-200 placeholder:text-gray-500 transition-all duration-300"></div></div>
                    <div><label for="password" class="block text-sm font-medium text-gray-400 mb-2">Password</label><div class="relative"><i class='bx bxs-lock-alt absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-lg'></i><input type="password" name="password" id="password" placeholder="Enter password" required class="w-full pl-10 pr-10 py-3 rounded-lg border border-slate-600 bg-slate-800/50 focus:border-violet-500 focus:ring-0 focus:outline-none text-gray-200 placeholder:text-gray-500 transition-all duration-300"><span id="togglePassword" class="password-toggle absolute right-3 top-1/2 transform -translate-y-1/2"><i class='bx bx-hide text-gray-500 text-lg'></i></span></div><div class="text-right mt-2"><a href="/forgot/" class="text-xs text-violet-400 hover:text-violet-300 hover:underline transition-colors">Forgot Password?</a></div></div>
                    <button type="submit" class="w-full bg-slate-700 text-white py-3 px-4 rounded-lg font-semibold flex items-center justify-center space-x-2 transition-all duration-300 hover:bg-slate-600 hover:shadow-lg hover:shadow-slate-500/20 hover:scale-[1.02]"><i class='bx bx-log-in-circle text-xl'></i><span>Sign In with Email</span></button>
                </form>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {

            // --- 1. PASSWORD TOGGLE ---
            const togglePassword = document.getElementById('togglePassword');
            if (togglePassword) {
                togglePassword.addEventListener('click', function() {
                    const password = document.getElementById('password');
                    const icon = this.querySelector('i');
                    if (password.type === 'password') {
                        password.type = 'text';
                        icon.classList.replace('bx-hide', 'bx-show');
                    } else {
                        password.type = 'password';
                        icon.classList.replace('bx-show', 'bx-hide');
                    }
                });
            }

            // --- 2. SMOOTH 3D TILT EFFECT ---
            const loginCard = document.getElementById('login-card');
            if (loginCard) {
                let targetX = 0, targetY = 0;
                let currentX = 0, currentY = 0;
                const smoothing = 0.05;
                const updateCardTilt = () => {
                    currentX += (targetX - currentX) * smoothing;
                    currentY += (targetY - currentY) * smoothing;
                    const xDeg = currentY * 20;
                    const yDeg = -currentX * 20;
                    loginCard.style.transform = `perspective(1000px) scale(1.05) rotateX(${xDeg}deg) rotateY(${yDeg}deg)`;
                    requestAnimationFrame(updateCardTilt);
                };
                updateCardTilt();
                const container = loginCard.parentElement;
                container.addEventListener('mousemove', (e) => {
                    const rect = container.getBoundingClientRect();
                    const centerX = rect.left + rect.width / 2;
                    const centerY = rect.top + rect.height / 2;
                    targetX = (e.clientX - centerX) / (rect.width / 2);
                    targetY = (e.clientY - centerY) / (rect.height / 2);
                });
                container.addEventListener('mouseleave', () => {
                    targetX = 0;
                    targetY = 0;
                });
            }

            // --- 3. TYPEWRITER EFFECT ---
            const taglineEl = document.getElementById('tagline');
            if (taglineEl) {
                const text = 'Unlock the future of music. On-chain.';
                let i = 0;
                taglineEl.innerHTML = '<span id="typewriter-cursor">|</span>';
                function typeWriter() {
                    if (i < text.length) {
                        taglineEl.innerHTML = text.substring(0, i + 1) + '<span id="typewriter-cursor">|</span>';
                        i++;
                        setTimeout(typeWriter, 60);
                    } else {
                        taglineEl.querySelector('#typewriter-cursor').style.animation = 'blink 1s step-end infinite';
                    }
                }
                setTimeout(typeWriter, 500);
            }
            
            // --- 4. ANIMATED PARTICLE BACKGROUND (FIXED) ---
            const canvas = document.getElementById('particle-canvas');
            if(canvas) {
                const ctx = canvas.getContext('2d');
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;

                let particlesArray;
                const mouse = { x: null, y: null, radius: (canvas.height / 100) * (canvas.width / 100) };
                
                window.addEventListener('mousemove', e => { mouse.x = e.x; mouse.y = e.y; });
                
                class Particle {
                    constructor(x, y, dX, dY, size) {
                        this.x = x; this.y = y; this.directionX = dX; this.directionY = dY; this.size = size;
                    }
                    draw() {
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false);
                        ctx.fillStyle = 'rgba(167, 139, 250, 0.4)';
                        ctx.fill();
                    }
                    update() {
                        if (this.x > canvas.width || this.x < 0) this.directionX = -this.directionX;
                        if (this.y > canvas.height || this.y < 0) this.directionY = -this.directionY;
                        
                        // --- MOUSE INTERACTION LOGIC RESTORED ---
                        let dx = mouse.x - this.x;
                        let dy = mouse.y - this.y;
                        let distance = Math.sqrt(dx*dx + dy*dy);
                        if (distance < mouse.radius + this.size){
                            if(mouse.x < this.x && this.x < canvas.width - this.size * 10) { this.x += 1; }
                            if(mouse.x > this.x && this.x > this.size * 10) { this.x -= 1; }
                            if(mouse.y < this.y && this.y < canvas.height - this.size * 10) { this.y += 1; }
                            if(mouse.y > this.y && this.y > this.size * 10) { this.y -= 1; }
                        }
                        // --- END OF RESTORED LOGIC ---

                        this.x += this.directionX;
                        this.y += this.directionY;
                        this.draw();
                    }
                }

                function init() {
                    particlesArray = [];
                    let numParticles = (canvas.height * canvas.width) / 9000;
                    for (let i = 0; i < numParticles; i++) {
                        let size = (Math.random() * 2) + 1;
                        let x = (Math.random() * ((innerWidth - size * 2) - (size * 2)) + size * 2);
                        let y = (Math.random() * ((innerHeight - size * 2) - (size * 2)) + size * 2);
                        let dX = (Math.random() * 0.4) - 0.2;
                        let dY = (Math.random() * 0.4) - 0.2;
                        particlesArray.push(new Particle(x, y, dX, dY, size));
                    }
                }

                function animate() {
                    requestAnimationFrame(animate);
                    ctx.clearRect(0, 0, innerWidth, innerHeight);
                    for (let i = 0; i < particlesArray.length; i++) {
                        particlesArray[i].update();
                    }
                    connect();
                }

                function connect() {
                    let opacityValue = 1;
                    for (let a = 0; a < particlesArray.length; a++) {
                        for (let b = a; b < particlesArray.length; b++) {
                            let distance = Math.pow(particlesArray[a].x - particlesArray[b].x, 2) + Math.pow(particlesArray[a].y - particlesArray[b].y, 2);
                            if (distance < (canvas.width / 7) * (canvas.height / 7)) {
                                opacityValue = 1 - (distance / 20000);
                                ctx.strokeStyle = `rgba(244, 114, 182, ${opacityValue})`;
                                ctx.lineWidth = 0.5;
                                ctx.beginPath();
                                ctx.moveTo(particlesArray[a].x, particlesArray[a].y);
                                ctx.lineTo(particlesArray[b].x, particlesArray[b].y);
                                ctx.stroke();
                            }
                        }
                    }
                }

                window.addEventListener('resize', () => {
                    canvas.width = innerWidth; canvas.height = innerHeight;
                    mouse.radius = (canvas.height / 100) * (canvas.width / 100);
                    init();
                });
                window.addEventListener('mouseout', () => { mouse.x = undefined; mouse.y = undefined; });
                
                init();
                animate();
            }
        });
    </script>
</body>
</html>
{{end}}